groups:
  - name: nodejs_alerts
    rules:
      - alert: EventLoopLagHigh
        expr: nodejs_eventloop_lag_mean_seconds > 0.001
        for: 1m
        labels:
          severity: warning
        annotations:
          summary: "Event loop lag is high"
          description: "Mean event loop lag is {{ $value }} seconds"

      - alert: NodeMemoryHigh
        expr: process_resident_memory_bytes / 1024 / 1024 > 500
        for: 2m
        labels:
          severity: warning
        annotations:
          summary: "Node.js memory usage high"
          description: "Memory usage is {{ $value }} MB"